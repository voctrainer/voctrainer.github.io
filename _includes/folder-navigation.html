<div class="folder-navigation">
    <h3 style="margin: 0 0 15px 0; color: #2c3e50;">
        üìÅ –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
    </h3>
    
    <div id="static-navigation">
        <div style="color: #7f8c8d; font-style: italic; padding: 20px; text-align: center;">
            –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏...
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    loadNavigation();
});

async function loadNavigation() {
    try {
        const currentPath = window.location.pathname;
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –∫ navigation.json
        let navFile;
        if (currentPath === '/partitures/' || currentPath === '/partitures') {
            navFile = '/partitures/navigation.json';
        } else {
            // –î–ª—è –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –ø–∞–ø–æ–∫
            navFile = currentPath.endsWith('/') 
                ? currentPath + 'navigation.json' 
                : currentPath + '/navigation.json';
        }
        
        console.log('Loading navigation from:', navFile);
        
        const response = await fetch(navFile);
        if (!response.ok) throw new Error(`Navigation file not found: ${navFile}`);
        
        const navData = await response.json();
        renderNavigation(navData, currentPath);
        
    } catch (error) {
        console.error('Error loading navigation:', error);
        document.getElementById('static-navigation').innerHTML = 
            '<div style="color: #7f8c8d; font-style: italic; padding: 20px; text-align: center;">–ù–∞–≤–∏–≥–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞</div>';
    }
}

function renderNavigation(navData, currentPath) {
    let html = '<ul style="list-style: none; padding-left: 0; margin: 0;">';
    
    let hasContent = false;
    
    // –ü–∞–ø–∫–∏
    if (navData.folders && navData.folders.length > 0) {
        hasContent = true;
        navData.folders.forEach(folder => {
            const folderPath = folder.path.startsWith('/') ? folder.path : '/' + folder.path;
            html += `
                <li style="margin-bottom: 8px;">
                    <a href="${folderPath}/" style="
                        color: #e67e22;
                        text-decoration: none;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        padding: 8px 12px;
                        background: white;
                        border-radius: 5px;
                        border: 1px solid #e9ecef;
                        font-weight: bold;
                        transition: all 0.2s;
                    " onmouseover="this.style.backgroundColor='#fff3e0'; this.style.borderColor='#e67e22';"
                       onmouseout="this.style.backgroundColor='white'; this.style.borderColor='#e9ecef';">
                        üìÅ ${folder.displayName}
                    </a>
                </li>
            `;
        });
    }
    
    // –§–∞–π–ª—ã
    if (navData.files && navData.files.length > 0) {
        hasContent = true;
        navData.files.forEach(file => {
            const filePath = file.path.startsWith('/') ? file.path : '/' + file.path;
            html += `
                <li style="margin-bottom: 8px;">
                    <a href="${filePath}" style="
                        color: #2c3e50;
                        text-decoration: none;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        padding: 8px 12px;
                        background: white;
                        border-radius: 5px;
                        border: 1px solid #e9ecef;
                        transition: all 0.2s;
                    " onmouseover="this.style.backgroundColor='#f8f9fa'; this.style.borderColor='#4051b5';"
                       onmouseout="this.style.backgroundColor='white'; this.style.borderColor='#e9ecef';">
                        üìÑ ${file.displayName}
                    </a>
                </li>
            `;
        });
    }
    
    html += '</ul>';
    
    if (hasContent) {
        document.getElementById('static-navigation').innerHTML = html;
    } else {
        document.getElementById('static-navigation').innerHTML = 
            '<div style="color: #7f8c8d; font-style: italic; padding: 20px; text-align: center;">–ü–∞–ø–∫–∞ –ø—É—Å—Ç–∞</div>';
    }
}
</script>
