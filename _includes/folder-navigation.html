<div class="folder-navigation">
    {% comment %} –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â–∏–π –ø—É—Ç—å {% endcomment %}
    {% assign current_path = page.url %}
    {% assign path_parts = current_path | split: '/' %}
    {% assign current_dir = path_parts | pop | join: '/' %}
    
    {% comment %} –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ–∫—É—â–µ–π –ø–∞–ø–∫–∏ {% endcomment %}
    {% assign nav_file_path = current_path | append: '_navigation.json' | replace: '//', '/' %}
    {% assign nav_data = site.data.navigation[current_path] %}
    
    {% comment %} –ï—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ —Ñ–∞–π–ª–∞ {% endcomment %}
    {% unless nav_data %}
        {% assign nav_file = current_path | append: '_navigation.json' | replace: '//', '/' %}
        {% for file in site.static_files %}
            {% if file.path == nav_file %}
                {% assign nav_data = file %}
            {% endif %}
        {% endfor %}
    {% endunless %}
    
    <h3 style="margin: 0 0 15px 0; color: #2c3e50;">
        üìÅ –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
    </h3>
    
    {% if nav_data %}
        <div id="static-navigation">
            {% comment %} –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é {% endcomment %}
            <ul style="list-style: none; padding-left: 0; margin: 0;">
                {% include navigation-tree.html navigation=nav_data current_path=current_path %}
            </ul>
        </div>
    {% else %}
        <div style="color: #7f8c8d; font-style: italic; padding: 20px; text-align: center;">
            –ù–∞–≤–∏–≥–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...
        </div>
        
        {% comment %} Fallback: –ø—Ä–æ—Å—Ç–∞—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è {% endcomment %}
        <script>
        document.addEventListener('DOMContentLoaded', function() {
            loadFallbackNavigation('{{ current_path }}');
        });
        
        async function loadFallbackNavigation(currentPath) {
            try {
                const navFile = currentPath + (currentPath.endsWith('/') ? '' : '/') + '_navigation.json';
                const response = await fetch(navFile);
                if (!response.ok) throw new Error('Navigation file not found');
                
                const navData = await response.json();
                renderNavigation(navData, currentPath);
            } catch (error) {
                console.error('Error loading navigation:', error);
                document.getElementById('static-navigation').innerHTML = 
                    '<div style="color: #7f8c8d; font-style: italic; padding: 20px; text-align: center;">–ü–∞–ø–∫–∞ –ø—É—Å—Ç–∞</div>';
            }
        }
        
        function renderNavigation(navData, currentPath) {
            let html = '';
            
            // –ü–∞–ø–∫–∏
            navData.folders.forEach(folder => {
                html += `
                    <li style="margin-bottom: 8px;">
                        <a href="${currentPath}${folder.path}/" style="
                            color: #e67e22;
                            text-decoration: none;
                            display: flex;
                            align-items: center;
                            gap: 8px;
                            padding: 8px 12px;
                            background: white;
                            border-radius: 5px;
                            border: 1px solid #e9ecef;
                            font-weight: bold;
                            transition: all 0.2s;
                        " onmouseover="this.style.backgroundColor='#fff3e0'; this.style.borderColor='#e67e22';"
                           onmouseout="this.style.backgroundColor='white'; this.style.borderColor='#e9ecef';">
                            üìÅ ${folder.displayName}
                        </a>
                    </li>
                `;
            });
            
            // –§–∞–π–ª—ã
            navData.files.forEach(file => {
                html += `
                    <li style="margin-bottom: 8px;">
                        <a href="${currentPath}${file.path}" style="
                            color: #2c3e50;
                            text-decoration: none;
                            display: flex;
                            align-items: center;
                            gap: 8px;
                            padding: 8px 12px;
                            background: white;
                            border-radius: 5px;
                            border: 1px solid #e9ecef;
                            transition: all 0.2s;
                        " onmouseover="this.style.backgroundColor='#f8f9fa'; this.style.borderColor='#4051b5';"
                           onmouseout="this.style.backgroundColor='white'; this.style.borderColor='#e9ecef';">
                            üìÑ ${file.displayName}
                        </a>
                    </li>
                `;
            });
            
            document.getElementById('static-navigation').innerHTML = html;
        }
        </script>
    {% endif %}
</div>
